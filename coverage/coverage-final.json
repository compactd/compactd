{"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\setup-tests.js": {"path":"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\setup-tests.js","statementMap":{"0":{"start":{"line":1,"column":0},"end":{"line":3,"column":3}},"1":{"start":{"line":2,"column":2},"end":{"line":2,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":33},"end":{"line":1,"column":34}},"loc":{"start":{"line":1,"column":50},"end":{"line":3,"column":1}},"line":1}},"branchMap":{},"s":{"0":1,"1":0},"f":{"0":0},"b":{},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"816fb0d7a5f50823da77be8668ff24fcb13bf40b"}
,"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\Artwork.tsx": {"path":"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\Artwork.tsx","statementMap":{"0":{"start":{"line":6,"column":8},"end":{"line":6,"column":28}},"1":{"start":{"line":7,"column":8},"end":{"line":7,"column":29}},"2":{"start":{"line":8,"column":8},"end":{"line":8,"column":46}},"3":{"start":{"line":9,"column":8},"end":{"line":11,"column":11}},"4":{"start":{"line":14,"column":8},"end":{"line":14,"column":46}},"5":{"start":{"line":17,"column":8},"end":{"line":17,"column":46}},"6":{"start":{"line":20,"column":8},"end":{"line":28,"column":11}},"7":{"start":{"line":21,"column":12},"end":{"line":23,"column":13}},"8":{"start":{"line":22,"column":16},"end":{"line":22,"column":37}},"9":{"start":{"line":24,"column":12},"end":{"line":24,"column":51}},"10":{"start":{"line":25,"column":12},"end":{"line":27,"column":15}},"11":{"start":{"line":26,"column":16},"end":{"line":26,"column":30}},"12":{"start":{"line":36,"column":23},"end":{"line":36,"column":49}},"13":{"start":{"line":37,"column":8},"end":{"line":52,"column":11}},"14":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"15":{"start":{"line":39,"column":16},"end":{"line":39,"column":44}},"16":{"start":{"line":41,"column":12},"end":{"line":51,"column":15}},"17":{"start":{"line":42,"column":16},"end":{"line":42,"column":59}},"18":{"start":{"line":43,"column":16},"end":{"line":48,"column":19}},"19":{"start":{"line":47,"column":20},"end":{"line":47,"column":38}},"20":{"start":{"line":50,"column":16},"end":{"line":50,"column":56}},"21":{"start":{"line":55,"column":8},"end":{"line":60,"column":9}},"22":{"start":{"line":56,"column":12},"end":{"line":58,"column":13}},"23":{"start":{"line":57,"column":16},"end":{"line":57,"column":78}},"24":{"start":{"line":59,"column":12},"end":{"line":59,"column":51}},"25":{"start":{"line":61,"column":8},"end":{"line":61,"column":33}},"26":{"start":{"line":64,"column":8},"end":{"line":64,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":33},"end":{"line":12,"column":5}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":42},"end":{"line":15,"column":5}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":42},"end":{"line":18,"column":5}},"line":16},"3":{"name":"(anonymous_3)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":33},"end":{"line":29,"column":5}},"line":19},"4":{"name":"(anonymous_4)","decl":{"start":{"line":20,"column":27},"end":{"line":20,"column":28}},"loc":{"start":{"line":20,"column":40},"end":{"line":28,"column":9}},"line":20},"5":{"name":"(anonymous_5)","decl":{"start":{"line":25,"column":44},"end":{"line":25,"column":45}},"loc":{"start":{"line":25,"column":50},"end":{"line":27,"column":13}},"line":25},"6":{"name":"(anonymous_6)","decl":{"start":{"line":35,"column":4},"end":{"line":35,"column":5}},"loc":{"start":{"line":35,"column":30},"end":{"line":53,"column":5}},"line":35},"7":{"name":"(anonymous_7)","decl":{"start":{"line":37,"column":30},"end":{"line":37,"column":31}},"loc":{"start":{"line":37,"column":36},"end":{"line":52,"column":9}},"line":37},"8":{"name":"(anonymous_8)","decl":{"start":{"line":41,"column":66},"end":{"line":41,"column":67}},"loc":{"start":{"line":41,"column":75},"end":{"line":49,"column":13}},"line":41},"9":{"name":"(anonymous_9)","decl":{"start":{"line":46,"column":24},"end":{"line":46,"column":25}},"loc":{"start":{"line":46,"column":33},"end":{"line":48,"column":17}},"line":46},"10":{"name":"(anonymous_10)","decl":{"start":{"line":49,"column":20},"end":{"line":49,"column":21}},"loc":{"start":{"line":49,"column":29},"end":{"line":51,"column":13}},"line":49},"11":{"name":"(anonymous_11)","decl":{"start":{"line":54,"column":4},"end":{"line":54,"column":5}},"loc":{"start":{"line":54,"column":40},"end":{"line":62,"column":5}},"line":54},"12":{"name":"(anonymous_12)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":33},"end":{"line":65,"column":5}},"line":63}},"branchMap":{"0":{"loc":{"start":{"line":5,"column":16},"end":{"line":5,"column":31}},"type":"default-arg","locations":[{"start":{"line":5,"column":24},"end":{"line":5,"column":31}}],"line":5},"1":{"loc":{"start":{"line":13,"column":23},"end":{"line":13,"column":32}},"type":"default-arg","locations":[{"start":{"line":13,"column":30},"end":{"line":13,"column":32}}],"line":13},"2":{"loc":{"start":{"line":16,"column":23},"end":{"line":16,"column":32}},"type":"default-arg","locations":[{"start":{"line":16,"column":30},"end":{"line":16,"column":32}}],"line":16},"3":{"loc":{"start":{"line":21,"column":12},"end":{"line":23,"column":13}},"type":"if","locations":[{"start":{"line":21,"column":12},"end":{"line":23,"column":13}},{"start":{"line":21,"column":12},"end":{"line":23,"column":13}}],"line":21},"4":{"loc":{"start":{"line":21,"column":16},"end":{"line":21,"column":48}},"type":"binary-expr","locations":[{"start":{"line":21,"column":16},"end":{"line":21,"column":23}},{"start":{"line":21,"column":27},"end":{"line":21,"column":48}}],"line":21},"5":{"loc":{"start":{"line":36,"column":23},"end":{"line":36,"column":49}},"type":"cond-expr","locations":[{"start":{"line":36,"column":32},"end":{"line":36,"column":42}},{"start":{"line":36,"column":45},"end":{"line":36,"column":49}}],"line":36},"6":{"loc":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"type":"if","locations":[{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},{"start":{"line":38,"column":12},"end":{"line":40,"column":13}}],"line":38},"7":{"loc":{"start":{"line":54,"column":23},"end":{"line":54,"column":38}},"type":"default-arg","locations":[{"start":{"line":54,"column":31},"end":{"line":54,"column":38}}],"line":54},"8":{"loc":{"start":{"line":55,"column":8},"end":{"line":60,"column":9}},"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":60,"column":9}},{"start":{"line":55,"column":8},"end":{"line":60,"column":9}}],"line":55},"9":{"loc":{"start":{"line":56,"column":12},"end":{"line":58,"column":13}},"type":"if","locations":[{"start":{"line":56,"column":12},"end":{"line":58,"column":13}},{"start":{"line":56,"column":12},"end":{"line":58,"column":13}}],"line":56}},"s":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[0],"1":[0],"2":[0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"Artwork.js","sourceRoot":"","sources":["Artwork.tsx"],"names":[],"mappings":"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","sourcesContent":["import PouchDB from 'pouchdb';\r\nimport * as PQueue from 'p-queue';\r\nimport Session from 'api/session';\r\n\r\nexport default class Artwork {\r\n  private queue: PQueue;\r\n\r\n  private blobCache: {\r\n    [id: string]: [number, Promise<string>]\r\n  } = {};\r\n\r\n  private artworks: PouchDB.Database<{}>;\r\n  private static sInstance: Artwork;\r\n\r\n  private PouchDB: PouchDB.Static;\r\n  private constructor (pouch = PouchDB) {\r\n    this.PouchDB = pouch;\r\n    this.artworks = new pouch('artworks');\r\n    this.queue = new PQueue({\r\n      concurrency: 2,\r\n    });\r\n  }\r\n\r\n  loadLargeCover (id: string, size = 64, target: HTMLImageElement) {\r\n    return this.load(id, 'large', target);\r\n  }\r\n\r\n  loadSmallCover (id: string, size = 32, target: HTMLImageElement) {\r\n    return this.load(id, 'small', target);\r\n  }\r\n\r\n  attach (blob: Blob, target: HTMLImageElement, oldSrc: string): Promise<Blob> {\r\n    return new Promise((resolve) => {\r\n      if (!target || oldSrc !== target.src) {\r\n        return resolve(blob);\r\n      }\r\n      target.src = URL.createObjectURL(blob);\r\n      target.addEventListener('load', () => {\r\n        resolve(blob);\r\n      });\r\n    });\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param docId the document id, starting with or without artowrks/\r\n   * @param size the size, either large (300px) or small (64px)\r\n   */\r\n  load (docId: string, size: 'large' | 'small', target: HTMLImageElement): Promise<Blob> {\r\n    const oldSrc = target ? target.src : null;\r\n    return this.queue.add(() => {\r\n      if (!docId.startsWith('artworks/')) {\r\n        docId = 'artworks/' + docId;\r\n      }\r\n      return this.artworks.getAttachment(docId, size).catch((err) => {\r\n        console.log('No attachment for: ' + docId);\r\n        return fetch('/api/assets/no-album.jpg', {\r\n          method: 'GET',\r\n          headers: Session.headers()\r\n        }).then((res) => {\r\n          return res.blob();\r\n        });\r\n      }).then((res: Blob) => {\r\n        return this.attach(res, target, oldSrc);\r\n      });\r\n    });\r\n  }\r\n  public static getInstance (pouch = PouchDB) {\r\n    if (!Artwork.sInstance) {\r\n      if (!pouch) {\r\n        throw new Error(\"Missing pouch parameter for initialization\");\r\n      }\r\n      Artwork.sInstance = new Artwork(pouch);\r\n    }\r\n    return Artwork.sInstance;\r\n  }\r\n  public static createInstance (pouch?: typeof PouchDB) {\r\n    Artwork.sInstance = new Artwork(pouch);\r\n  }\r\n}\r\n"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"7ed8b1e4e8458b75ca8531c3faad08aa79cc48f4"}
,"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\session.tsx": {"path":"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\session.tsx","statementMap":{"0":{"start":{"line":5,"column":8},"end":{"line":5,"column":41}},"1":{"start":{"line":6,"column":8},"end":{"line":6,"column":31}},"2":{"start":{"line":9,"column":8},"end":{"line":9,"column":39}},"3":{"start":{"line":12,"column":8},"end":{"line":12,"column":52}},"4":{"start":{"line":15,"column":8},"end":{"line":15,"column":52}},"5":{"start":{"line":18,"column":8},"end":{"line":19,"column":24}},"6":{"start":{"line":19,"column":12},"end":{"line":19,"column":24}},"7":{"start":{"line":20,"column":8},"end":{"line":20,"column":26}},"8":{"start":{"line":23,"column":24},"end":{"line":23,"column":42}},"9":{"start":{"line":24,"column":8},"end":{"line":25,"column":25}},"10":{"start":{"line":25,"column":12},"end":{"line":25,"column":25}},"11":{"start":{"line":26,"column":8},"end":{"line":28,"column":9}},"12":{"start":{"line":27,"column":12},"end":{"line":27,"column":25}},"13":{"start":{"line":29,"column":8},"end":{"line":31,"column":9}},"14":{"start":{"line":30,"column":12},"end":{"line":30,"column":25}},"15":{"start":{"line":32,"column":8},"end":{"line":32,"column":20}},"16":{"start":{"line":35,"column":21},"end":{"line":35,"column":23}},"17":{"start":{"line":36,"column":8},"end":{"line":38,"column":9}},"18":{"start":{"line":37,"column":12},"end":{"line":37,"column":42}},"19":{"start":{"line":39,"column":8},"end":{"line":39,"column":68}},"20":{"start":{"line":39,"column":56},"end":{"line":39,"column":66}},"21":{"start":{"line":42,"column":8},"end":{"line":51,"column":11}},"22":{"start":{"line":46,"column":25},"end":{"line":46,"column":35}},"23":{"start":{"line":47,"column":12},"end":{"line":47,"column":37}},"24":{"start":{"line":48,"column":12},"end":{"line":48,"column":47}},"25":{"start":{"line":50,"column":12},"end":{"line":50,"column":66}},"26":{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},"27":{"start":{"line":55,"column":12},"end":{"line":58,"column":16}},"28":{"start":{"line":60,"column":8},"end":{"line":60,"column":104}},"29":{"start":{"line":63,"column":8},"end":{"line":66,"column":9}},"30":{"start":{"line":64,"column":12},"end":{"line":64,"column":70}},"31":{"start":{"line":65,"column":12},"end":{"line":65,"column":27}},"32":{"start":{"line":67,"column":8},"end":{"line":69,"column":12}},"33":{"start":{"line":72,"column":8},"end":{"line":74,"column":11}},"34":{"start":{"line":77,"column":8},"end":{"line":77,"column":48}},"35":{"start":{"line":80,"column":8},"end":{"line":80,"column":22}},"36":{"start":{"line":81,"column":20},"end":{"line":81,"column":97}},"37":{"start":{"line":82,"column":8},"end":{"line":85,"column":12}},"38":{"start":{"line":83,"column":29},"end":{"line":83,"column":44}},"39":{"start":{"line":84,"column":12},"end":{"line":84,"column":38}},"40":{"start":{"line":88,"column":17},"end":{"line":88,"column":37}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":4},"end":{"line":4,"column":5}},"loc":{"start":{"line":4,"column":47},"end":{"line":7,"column":5}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":14},"end":{"line":10,"column":5}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":15},"end":{"line":13,"column":5}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":20},"end":{"line":16,"column":5}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":41},"end":{"line":21,"column":5}},"line":17},"5":{"name":"(anonymous_5)","decl":{"start":{"line":22,"column":4},"end":{"line":22,"column":5}},"loc":{"start":{"line":22,"column":17},"end":{"line":33,"column":5}},"line":22},"6":{"name":"(anonymous_6)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":16},"end":{"line":40,"column":5}},"line":34},"7":{"name":"(anonymous_7)","decl":{"start":{"line":39,"column":47},"end":{"line":39,"column":48}},"loc":{"start":{"line":39,"column":56},"end":{"line":39,"column":66}},"line":39},"8":{"name":"(anonymous_8)","decl":{"start":{"line":41,"column":4},"end":{"line":41,"column":5}},"loc":{"start":{"line":41,"column":31},"end":{"line":52,"column":5}},"line":41},"9":{"name":"(anonymous_9)","decl":{"start":{"line":46,"column":16},"end":{"line":46,"column":17}},"loc":{"start":{"line":46,"column":25},"end":{"line":46,"column":35}},"line":46},"10":{"name":"(anonymous_10)","decl":{"start":{"line":46,"column":42},"end":{"line":46,"column":43}},"loc":{"start":{"line":46,"column":51},"end":{"line":49,"column":9}},"line":46},"11":{"name":"(anonymous_11)","decl":{"start":{"line":49,"column":17},"end":{"line":49,"column":18}},"loc":{"start":{"line":49,"column":26},"end":{"line":51,"column":9}},"line":49},"12":{"name":"(anonymous_12)","decl":{"start":{"line":53,"column":4},"end":{"line":53,"column":5}},"loc":{"start":{"line":53,"column":53},"end":{"line":61,"column":5}},"line":53},"13":{"name":"(anonymous_13)","decl":{"start":{"line":62,"column":4},"end":{"line":62,"column":5}},"loc":{"start":{"line":62,"column":26},"end":{"line":70,"column":5}},"line":62},"14":{"name":"(anonymous_14)","decl":{"start":{"line":71,"column":4},"end":{"line":71,"column":5}},"loc":{"start":{"line":71,"column":20},"end":{"line":75,"column":5}},"line":71},"15":{"name":"(anonymous_15)","decl":{"start":{"line":76,"column":4},"end":{"line":76,"column":5}},"loc":{"start":{"line":76,"column":13},"end":{"line":78,"column":5}},"line":76},"16":{"name":"(anonymous_16)","decl":{"start":{"line":79,"column":4},"end":{"line":79,"column":5}},"loc":{"start":{"line":79,"column":14},"end":{"line":86,"column":5}},"line":79},"17":{"name":"(anonymous_17)","decl":{"start":{"line":82,"column":35},"end":{"line":82,"column":36}},"loc":{"start":{"line":82,"column":43},"end":{"line":85,"column":9}},"line":82}},"branchMap":{"0":{"loc":{"start":{"line":4,"column":16},"end":{"line":4,"column":45}},"type":"default-arg","locations":[{"start":{"line":4,"column":26},"end":{"line":4,"column":45}}],"line":4},"1":{"loc":{"start":{"line":17,"column":16},"end":{"line":17,"column":39}},"type":"default-arg","locations":[{"start":{"line":17,"column":24},"end":{"line":17,"column":39}}],"line":17},"2":{"loc":{"start":{"line":18,"column":8},"end":{"line":19,"column":24}},"type":"if","locations":[{"start":{"line":18,"column":8},"end":{"line":19,"column":24}},{"start":{"line":18,"column":8},"end":{"line":19,"column":24}}],"line":18},"3":{"loc":{"start":{"line":24,"column":8},"end":{"line":25,"column":25}},"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":25,"column":25}},{"start":{"line":24,"column":8},"end":{"line":25,"column":25}}],"line":24},"4":{"loc":{"start":{"line":26,"column":8},"end":{"line":28,"column":9}},"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":28,"column":9}},{"start":{"line":26,"column":8},"end":{"line":28,"column":9}}],"line":26},"5":{"loc":{"start":{"line":29,"column":8},"end":{"line":31,"column":9}},"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":31,"column":9}},{"start":{"line":29,"column":8},"end":{"line":31,"column":9}}],"line":29},"6":{"loc":{"start":{"line":29,"column":12},"end":{"line":29,"column":40}},"type":"binary-expr","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":25}},{"start":{"line":29,"column":29},"end":{"line":29,"column":40}}],"line":29},"7":{"loc":{"start":{"line":36,"column":8},"end":{"line":38,"column":9}},"type":"if","locations":[{"start":{"line":36,"column":8},"end":{"line":38,"column":9}},{"start":{"line":36,"column":8},"end":{"line":38,"column":9}}],"line":36},"8":{"loc":{"start":{"line":53,"column":17},"end":{"line":53,"column":51}},"type":"default-arg","locations":[{"start":{"line":53,"column":24},"end":{"line":53,"column":51}}],"line":53},"9":{"loc":{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":59,"column":9}},{"start":{"line":54,"column":8},"end":{"line":59,"column":9}}],"line":54},"10":{"loc":{"start":{"line":62,"column":12},"end":{"line":62,"column":24}},"type":"default-arg","locations":[{"start":{"line":62,"column":22},"end":{"line":62,"column":24}}],"line":62},"11":{"loc":{"start":{"line":63,"column":8},"end":{"line":66,"column":9}},"type":"if","locations":[{"start":{"line":63,"column":8},"end":{"line":66,"column":9}},{"start":{"line":63,"column":8},"end":{"line":66,"column":9}}],"line":63},"12":{"loc":{"start":{"line":71,"column":9},"end":{"line":71,"column":18}},"type":"default-arg","locations":[{"start":{"line":71,"column":16},"end":{"line":71,"column":18}}],"line":71}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":1},"f":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},"b":{"0":[1],"1":[0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0],"9":[0,0],"10":[0],"11":[0,0],"12":[0]},"inputSourceMap":{"version":3,"file":"session.js","sourceRoot":"","sources":["session.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as jwt from 'jwt-decode';\r\nimport PouchDB from 'pouchdb';\r\n\r\nclass SessionManager {\r\n  private storage: Storage;\r\n  private tokenName = 'session_token';\r\n\r\n  constructor(storage = window.localStorage) {\r\n    this.storage = storage;\r\n  }\r\n  public getUser () {\r\n    return this.decodeToken().user;\r\n  }\r\n  public getToken () {\r\n    return this.storage.getItem(this.tokenName);\r\n  }\r\n  protected setToken (token: string) {\r\n    this.storage.setItem(this.tokenName, token);\r\n  }\r\n  protected decodeToken (token = this.getToken()) {\r\n    if (!token) return null;\r\n    return jwt(token) as {\r\n      exp: number,\r\n      iat: number,\r\n      iss: string,\r\n      user: string,\r\n      ok: boolean\r\n    }\r\n  }\r\n  isSignedIn () {\r\n    const session = this.decodeToken();\r\n    if (!session) return false;\r\n    if (session.exp > Date.now()) {\r\n      return false;\r\n    }\r\n    if (!session.user || !session.ok) {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n  getStatus (): Promise<{\r\n    versions: {\r\n      server: string,\r\n      models: string,\r\n    },\r\n    user?: string\r\n  }> {\r\n    const init: RequestInit = {};\r\n    if (this.isSignedIn()) {\r\n      init.headers = this.headers();\r\n    }\r\n    return fetch('/api/status', init).then((res) => res.json());\r\n  }\r\n  signIn (username: string, password: string) {\r\n    return fetch('/api/sessions', {\r\n      method: 'POST',\r\n      headers: new Headers({'content-type': 'application/json'}),\r\n      body: JSON.stringify({username, password})\r\n    }).then((res) => res.json()).then((res) => {\r\n      \r\n      this.setToken(res.token)\r\n      \r\n      return this.decodeToken(res.token);\r\n    }).catch((err) => {\r\n      return Promise.reject('Invalid username or password');\r\n    });\r\n  }\r\n  fetch (input: RequestInfo, init: {\r\n    method: string,\r\n    body: any, \r\n    headers?: {\r\n      [name: string]: string\r\n    }\r\n  } = {method: 'GET', body: {}}) {\r\n    if (init.method === 'GET') {\r\n      return fetch(input, this.init({\r\n        method: 'GET',\r\n        headers: new Headers(init.headers)\r\n      }));\r\n    }\r\n\r\n    return fetch(input, this.init({\r\n      ...init,\r\n      headers: new Headers(init.headers)\r\n    }));\r\n  }\r\n  headers (headers: any = {}) {\r\n    if (headers instanceof Headers) {\r\n      headers.set('Authorization', `Bearer ${this.getToken()}`);\r\n      return headers;\r\n    }\r\n    return new Headers(Object.assign({}, headers, {\r\n      Authorization: `Bearer ${this.getToken()}`\r\n    }));\r\n  }\r\n  init (init: RequestInit = {}) {\r\n    return Object.assign({}, init, {\r\n      headers: this.headers(init.headers)\r\n    });\r\n  }\r\n  logout () {\r\n    this.storage.removeItem(this.tokenName);\r\n  }\r\n  destroy () {\r\n    this.logout();\r\n    const dbs =  [ 'artists', 'albums', 'tracks', 'artworks', 'files', 'trackers', 'libraries'];\r\n    return Promise.all(dbs.map((db) => {\r\n      const database = new PouchDB(db);\r\n      return database.destroy();\r\n    }));\r\n  }\r\n}\r\n\r\nconst instance = new SessionManager();\r\n\r\nexport default instance;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"10278e58ef7ee141ea1ecba4328f7e98eb72c1e7"}
,"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\models\\CompactdArtist.spec.tsx": {"path":"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\models\\CompactdArtist.spec.tsx","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":8,"column":1}},"1":{"start":{"line":2,"column":4},"end":{"line":7,"column":7}},"2":{"start":{"line":3,"column":36},"end":{"line":3,"column":97}},"3":{"start":{"line":3,"column":42},"end":{"line":3,"column":70}},"4":{"start":{"line":3,"column":85},"end":{"line":3,"column":95}},"5":{"start":{"line":4,"column":35},"end":{"line":4,"column":100}},"6":{"start":{"line":4,"column":41},"end":{"line":4,"column":73}},"7":{"start":{"line":4,"column":88},"end":{"line":4,"column":98}},"8":{"start":{"line":5,"column":32},"end":{"line":5,"column":149}},"9":{"start":{"line":5,"column":97},"end":{"line":5,"column":119}},"10":{"start":{"line":6,"column":8},"end":{"line":6,"column":78}},"11":{"start":{"line":14,"column":0},"end":{"line":14,"column":48}},"12":{"start":{"line":15,"column":16},"end":{"line":15,"column":53}},"13":{"start":{"line":16,"column":20},"end":{"line":16,"column":61}},"14":{"start":{"line":17,"column":16},"end":{"line":17,"column":37}},"15":{"start":{"line":18,"column":14},"end":{"line":22,"column":1}},"16":{"start":{"line":19,"column":4},"end":{"line":21,"column":7}},"17":{"start":{"line":20,"column":8},"end":{"line":20,"column":32}},"18":{"start":{"line":23,"column":0},"end":{"line":55,"column":3}},"19":{"start":{"line":24,"column":4},"end":{"line":30,"column":7}},"20":{"start":{"line":25,"column":8},"end":{"line":25,"column":29}},"21":{"start":{"line":26,"column":22},"end":{"line":26,"column":40}},"22":{"start":{"line":27,"column":23},"end":{"line":27,"column":61}},"23":{"start":{"line":28,"column":8},"end":{"line":28,"column":44}},"24":{"start":{"line":29,"column":8},"end":{"line":29,"column":62}},"25":{"start":{"line":31,"column":4},"end":{"line":35,"column":7}},"26":{"start":{"line":32,"column":23},"end":{"line":32,"column":45}},"27":{"start":{"line":33,"column":8},"end":{"line":33,"column":38}},"28":{"start":{"line":34,"column":8},"end":{"line":34,"column":52}},"29":{"start":{"line":36,"column":4},"end":{"line":41,"column":7}},"30":{"start":{"line":37,"column":23},"end":{"line":37,"column":52}},"31":{"start":{"line":38,"column":8},"end":{"line":38,"column":38}},"32":{"start":{"line":39,"column":8},"end":{"line":39,"column":40}},"33":{"start":{"line":40,"column":8},"end":{"line":40,"column":51}},"34":{"start":{"line":42,"column":4},"end":{"line":48,"column":7}},"35":{"start":{"line":43,"column":23},"end":{"line":43,"column":52}},"36":{"start":{"line":44,"column":22},"end":{"line":44,"column":45}},"37":{"start":{"line":45,"column":8},"end":{"line":45,"column":37}},"38":{"start":{"line":46,"column":8},"end":{"line":46,"column":39}},"39":{"start":{"line":47,"column":8},"end":{"line":47,"column":50}},"40":{"start":{"line":49,"column":4},"end":{"line":54,"column":7}},"41":{"start":{"line":50,"column":23},"end":{"line":50,"column":69}},"42":{"start":{"line":51,"column":8},"end":{"line":51,"column":40}},"43":{"start":{"line":52,"column":8},"end":{"line":52,"column":38}},"44":{"start":{"line":53,"column":8},"end":{"line":53,"column":51}},"45":{"start":{"line":56,"column":0},"end":{"line":61,"column":3}},"46":{"start":{"line":57,"column":4},"end":{"line":60,"column":7}},"47":{"start":{"line":58,"column":23},"end":{"line":58,"column":52}},"48":{"start":{"line":59,"column":8},"end":{"line":59,"column":66}},"49":{"start":{"line":62,"column":0},"end":{"line":93,"column":3}},"50":{"start":{"line":64,"column":4},"end":{"line":69,"column":7}},"51":{"start":{"line":65,"column":8},"end":{"line":68,"column":12}},"52":{"start":{"line":70,"column":4},"end":{"line":72,"column":7}},"53":{"start":{"line":71,"column":8},"end":{"line":71,"column":26}},"54":{"start":{"line":73,"column":4},"end":{"line":80,"column":8}},"55":{"start":{"line":73,"column":34},"end":{"line":80,"column":6}},"56":{"start":{"line":74,"column":8},"end":{"line":74,"column":29}},"57":{"start":{"line":75,"column":23},"end":{"line":75,"column":70}},"58":{"start":{"line":76,"column":8},"end":{"line":76,"column":28}},"59":{"start":{"line":77,"column":8},"end":{"line":77,"column":48}},"60":{"start":{"line":78,"column":8},"end":{"line":78,"column":62}},"61":{"start":{"line":79,"column":8},"end":{"line":79,"column":43}},"62":{"start":{"line":81,"column":4},"end":{"line":86,"column":8}},"63":{"start":{"line":81,"column":32},"end":{"line":86,"column":6}},"64":{"start":{"line":82,"column":8},"end":{"line":82,"column":29}},"65":{"start":{"line":83,"column":23},"end":{"line":83,"column":70}},"66":{"start":{"line":84,"column":8},"end":{"line":84,"column":28}},"67":{"start":{"line":85,"column":8},"end":{"line":85,"column":43}},"68":{"start":{"line":87,"column":4},"end":{"line":92,"column":8}},"69":{"start":{"line":87,"column":43},"end":{"line":92,"column":6}},"70":{"start":{"line":88,"column":8},"end":{"line":88,"column":29}},"71":{"start":{"line":89,"column":23},"end":{"line":89,"column":70}},"72":{"start":{"line":90,"column":8},"end":{"line":90,"column":28}},"73":{"start":{"line":91,"column":8},"end":{"line":91,"column":51}},"74":{"start":{"line":94,"column":0},"end":{"line":141,"column":3}},"75":{"start":{"line":96,"column":4},"end":{"line":100,"column":7}},"76":{"start":{"line":97,"column":8},"end":{"line":99,"column":11}},"77":{"start":{"line":101,"column":4},"end":{"line":103,"column":7}},"78":{"start":{"line":102,"column":8},"end":{"line":102,"column":26}},"79":{"start":{"line":104,"column":4},"end":{"line":110,"column":8}},"80":{"start":{"line":104,"column":79},"end":{"line":110,"column":6}},"81":{"start":{"line":105,"column":8},"end":{"line":105,"column":29}},"82":{"start":{"line":106,"column":20},"end":{"line":106,"column":82}},"83":{"start":{"line":107,"column":8},"end":{"line":107,"column":32}},"84":{"start":{"line":108,"column":8},"end":{"line":108,"column":50}},"85":{"start":{"line":109,"column":8},"end":{"line":109,"column":75}},"86":{"start":{"line":111,"column":4},"end":{"line":117,"column":8}},"87":{"start":{"line":111,"column":77},"end":{"line":117,"column":6}},"88":{"start":{"line":112,"column":8},"end":{"line":112,"column":29}},"89":{"start":{"line":113,"column":20},"end":{"line":113,"column":82}},"90":{"start":{"line":114,"column":8},"end":{"line":114,"column":32}},"91":{"start":{"line":115,"column":8},"end":{"line":115,"column":50}},"92":{"start":{"line":116,"column":8},"end":{"line":116,"column":74}},"93":{"start":{"line":118,"column":4},"end":{"line":126,"column":8}},"94":{"start":{"line":118,"column":82},"end":{"line":126,"column":6}},"95":{"start":{"line":119,"column":8},"end":{"line":119,"column":29}},"96":{"start":{"line":120,"column":20},"end":{"line":120,"column":92}},"97":{"start":{"line":121,"column":8},"end":{"line":121,"column":32}},"98":{"start":{"line":122,"column":8},"end":{"line":122,"column":50}},"99":{"start":{"line":123,"column":8},"end":{"line":125,"column":23}},"100":{"start":{"line":127,"column":4},"end":{"line":140,"column":8}},"101":{"start":{"line":127,"column":45},"end":{"line":140,"column":6}},"102":{"start":{"line":128,"column":8},"end":{"line":128,"column":29}},"103":{"start":{"line":129,"column":8},"end":{"line":131,"column":11}},"104":{"start":{"line":132,"column":20},"end":{"line":132,"column":92}},"105":{"start":{"line":133,"column":8},"end":{"line":133,"column":35}},"106":{"start":{"line":134,"column":8},"end":{"line":134,"column":38}},"107":{"start":{"line":135,"column":8},"end":{"line":135,"column":38}},"108":{"start":{"line":136,"column":8},"end":{"line":136,"column":50}},"109":{"start":{"line":137,"column":8},"end":{"line":139,"column":23}},"110":{"start":{"line":142,"column":0},"end":{"line":176,"column":3}},"111":{"start":{"line":143,"column":4},"end":{"line":175,"column":8}},"112":{"start":{"line":143,"column":44},"end":{"line":175,"column":6}},"113":{"start":{"line":144,"column":8},"end":{"line":144,"column":29}},"114":{"start":{"line":145,"column":24},"end":{"line":145,"column":65}},"115":{"start":{"line":146,"column":19},"end":{"line":149,"column":10}},"116":{"start":{"line":150,"column":19},"end":{"line":150,"column":45}},"117":{"start":{"line":151,"column":25},"end":{"line":151,"column":62}},"118":{"start":{"line":152,"column":18},"end":{"line":152,"column":22}},"119":{"start":{"line":153,"column":8},"end":{"line":153,"column":31}},"120":{"start":{"line":154,"column":21},"end":{"line":154,"column":33}},"121":{"start":{"line":155,"column":25},"end":{"line":155,"column":65}},"122":{"start":{"line":156,"column":20},"end":{"line":160,"column":10}},"123":{"start":{"line":161,"column":8},"end":{"line":161,"column":24}},"124":{"start":{"line":162,"column":8},"end":{"line":162,"column":26}},"125":{"start":{"line":163,"column":21},"end":{"line":167,"column":10}},"126":{"start":{"line":168,"column":8},"end":{"line":172,"column":11}},"127":{"start":{"line":173,"column":8},"end":{"line":173,"column":43}},"128":{"start":{"line":174,"column":8},"end":{"line":174,"column":15}},"129":{"start":{"line":177,"column":0},"end":{"line":210,"column":3}},"130":{"start":{"line":178,"column":4},"end":{"line":193,"column":8}},"131":{"start":{"line":178,"column":43},"end":{"line":193,"column":6}},"132":{"start":{"line":179,"column":22},"end":{"line":179,"column":73}},"133":{"start":{"line":180,"column":22},"end":{"line":183,"column":10}},"134":{"start":{"line":184,"column":20},"end":{"line":184,"column":69}},"135":{"start":{"line":185,"column":8},"end":{"line":185,"column":37}},"136":{"start":{"line":186,"column":8},"end":{"line":186,"column":43}},"137":{"start":{"line":187,"column":8},"end":{"line":187,"column":46}},"138":{"start":{"line":188,"column":8},"end":{"line":191,"column":12}},"139":{"start":{"line":192,"column":8},"end":{"line":192,"column":26}},"140":{"start":{"line":194,"column":4},"end":{"line":209,"column":8}},"141":{"start":{"line":194,"column":31},"end":{"line":209,"column":6}},"142":{"start":{"line":195,"column":22},"end":{"line":195,"column":73}},"143":{"start":{"line":196,"column":22},"end":{"line":199,"column":10}},"144":{"start":{"line":200,"column":20},"end":{"line":200,"column":69}},"145":{"start":{"line":201,"column":8},"end":{"line":201,"column":37}},"146":{"start":{"line":202,"column":8},"end":{"line":202,"column":43}},"147":{"start":{"line":203,"column":8},"end":{"line":203,"column":46}},"148":{"start":{"line":204,"column":8},"end":{"line":207,"column":12}},"149":{"start":{"line":208,"column":8},"end":{"line":208,"column":26}},"150":{"start":{"line":211,"column":0},"end":{"line":219,"column":3}},"151":{"start":{"line":212,"column":4},"end":{"line":218,"column":7}},"152":{"start":{"line":213,"column":21},"end":{"line":213,"column":80}},"153":{"start":{"line":213,"column":70},"end":{"line":213,"column":78}},"154":{"start":{"line":214,"column":20},"end":{"line":214,"column":61}},"155":{"start":{"line":215,"column":8},"end":{"line":217,"column":11}},"156":{"start":{"line":215,"column":38},"end":{"line":215,"column":42}},"157":{"start":{"line":220,"column":0},"end":{"line":226,"column":3}},"158":{"start":{"line":221,"column":4},"end":{"line":225,"column":7}},"159":{"start":{"line":222,"column":22},"end":{"line":222,"column":36}},"160":{"start":{"line":223,"column":20},"end":{"line":223,"column":55}},"161":{"start":{"line":224,"column":8},"end":{"line":224,"column":35}},"162":{"start":{"line":227,"column":0},"end":{"line":256,"column":3}},"163":{"start":{"line":228,"column":4},"end":{"line":237,"column":7}},"164":{"start":{"line":229,"column":22},"end":{"line":232,"column":9}},"165":{"start":{"line":233,"column":20},"end":{"line":233,"column":66}},"166":{"start":{"line":234,"column":8},"end":{"line":234,"column":35}},"167":{"start":{"line":235,"column":8},"end":{"line":235,"column":37}},"168":{"start":{"line":236,"column":8},"end":{"line":236,"column":51}},"169":{"start":{"line":238,"column":4},"end":{"line":249,"column":7}},"170":{"start":{"line":239,"column":22},"end":{"line":242,"column":9}},"171":{"start":{"line":243,"column":20},"end":{"line":245,"column":10}},"172":{"start":{"line":246,"column":8},"end":{"line":246,"column":35}},"173":{"start":{"line":247,"column":8},"end":{"line":247,"column":37}},"174":{"start":{"line":248,"column":8},"end":{"line":248,"column":51}},"175":{"start":{"line":250,"column":4},"end":{"line":255,"column":7}},"176":{"start":{"line":251,"column":20},"end":{"line":251,"column":74}},"177":{"start":{"line":252,"column":8},"end":{"line":252,"column":35}},"178":{"start":{"line":253,"column":8},"end":{"line":253,"column":36}},"179":{"start":{"line":254,"column":8},"end":{"line":254,"column":51}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":44},"end":{"line":1,"column":45}},"loc":{"start":{"line":1,"column":89},"end":{"line":8,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":2,"column":36},"end":{"line":2,"column":37}},"loc":{"start":{"line":2,"column":63},"end":{"line":7,"column":5}},"line":2},"2":{"name":"fulfilled","decl":{"start":{"line":3,"column":17},"end":{"line":3,"column":26}},"loc":{"start":{"line":3,"column":34},"end":{"line":3,"column":99}},"line":3},"3":{"name":"rejected","decl":{"start":{"line":4,"column":17},"end":{"line":4,"column":25}},"loc":{"start":{"line":4,"column":33},"end":{"line":4,"column":102}},"line":4},"4":{"name":"step","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":21}},"loc":{"start":{"line":5,"column":30},"end":{"line":5,"column":151}},"line":5},"5":{"name":"(anonymous_5)","decl":{"start":{"line":5,"column":76},"end":{"line":5,"column":77}},"loc":{"start":{"line":5,"column":95},"end":{"line":5,"column":121}},"line":5},"6":{"name":"(anonymous_6)","decl":{"start":{"line":18,"column":14},"end":{"line":18,"column":15}},"loc":{"start":{"line":18,"column":22},"end":{"line":22,"column":1}},"line":18},"7":{"name":"(anonymous_7)","decl":{"start":{"line":19,"column":23},"end":{"line":19,"column":24}},"loc":{"start":{"line":19,"column":36},"end":{"line":21,"column":5}},"line":19},"8":{"name":"(anonymous_8)","decl":{"start":{"line":23,"column":39},"end":{"line":23,"column":40}},"loc":{"start":{"line":23,"column":45},"end":{"line":55,"column":1}},"line":23},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":57},"end":{"line":24,"column":58}},"loc":{"start":{"line":24,"column":63},"end":{"line":30,"column":5}},"line":24},"10":{"name":"(anonymous_10)","decl":{"start":{"line":31,"column":59},"end":{"line":31,"column":60}},"loc":{"start":{"line":31,"column":65},"end":{"line":35,"column":5}},"line":31},"11":{"name":"(anonymous_11)","decl":{"start":{"line":36,"column":62},"end":{"line":36,"column":63}},"loc":{"start":{"line":36,"column":68},"end":{"line":41,"column":5}},"line":36},"12":{"name":"(anonymous_12)","decl":{"start":{"line":42,"column":53},"end":{"line":42,"column":54}},"loc":{"start":{"line":42,"column":59},"end":{"line":48,"column":5}},"line":42},"13":{"name":"(anonymous_13)","decl":{"start":{"line":49,"column":48},"end":{"line":49,"column":49}},"loc":{"start":{"line":49,"column":54},"end":{"line":54,"column":5}},"line":49},"14":{"name":"(anonymous_14)","decl":{"start":{"line":56,"column":33},"end":{"line":56,"column":34}},"loc":{"start":{"line":56,"column":39},"end":{"line":61,"column":1}},"line":56},"15":{"name":"(anonymous_15)","decl":{"start":{"line":57,"column":43},"end":{"line":57,"column":44}},"loc":{"start":{"line":57,"column":49},"end":{"line":60,"column":5}},"line":57},"16":{"name":"(anonymous_16)","decl":{"start":{"line":62,"column":32},"end":{"line":62,"column":33}},"loc":{"start":{"line":62,"column":38},"end":{"line":93,"column":1}},"line":62},"17":{"name":"(anonymous_17)","decl":{"start":{"line":64,"column":15},"end":{"line":64,"column":16}},"loc":{"start":{"line":64,"column":21},"end":{"line":69,"column":5}},"line":64},"18":{"name":"(anonymous_18)","decl":{"start":{"line":70,"column":14},"end":{"line":70,"column":15}},"loc":{"start":{"line":70,"column":20},"end":{"line":72,"column":5}},"line":70},"19":{"name":"(anonymous_19)","decl":{"start":{"line":73,"column":28},"end":{"line":73,"column":29}},"loc":{"start":{"line":73,"column":34},"end":{"line":80,"column":6}},"line":73},"20":{"name":"(anonymous_20)","decl":{"start":{"line":73,"column":66},"end":{"line":73,"column":67}},"loc":{"start":{"line":73,"column":79},"end":{"line":80,"column":5}},"line":73},"21":{"name":"(anonymous_21)","decl":{"start":{"line":81,"column":26},"end":{"line":81,"column":27}},"loc":{"start":{"line":81,"column":32},"end":{"line":86,"column":6}},"line":81},"22":{"name":"(anonymous_22)","decl":{"start":{"line":81,"column":64},"end":{"line":81,"column":65}},"loc":{"start":{"line":81,"column":77},"end":{"line":86,"column":5}},"line":81},"23":{"name":"(anonymous_23)","decl":{"start":{"line":87,"column":37},"end":{"line":87,"column":38}},"loc":{"start":{"line":87,"column":43},"end":{"line":92,"column":6}},"line":87},"24":{"name":"(anonymous_24)","decl":{"start":{"line":87,"column":75},"end":{"line":87,"column":76}},"loc":{"start":{"line":87,"column":88},"end":{"line":92,"column":5}},"line":87},"25":{"name":"(anonymous_25)","decl":{"start":{"line":94,"column":35},"end":{"line":94,"column":36}},"loc":{"start":{"line":94,"column":41},"end":{"line":141,"column":1}},"line":94},"26":{"name":"(anonymous_26)","decl":{"start":{"line":96,"column":15},"end":{"line":96,"column":16}},"loc":{"start":{"line":96,"column":21},"end":{"line":100,"column":5}},"line":96},"27":{"name":"(anonymous_27)","decl":{"start":{"line":101,"column":14},"end":{"line":101,"column":15}},"loc":{"start":{"line":101,"column":20},"end":{"line":103,"column":5}},"line":101},"28":{"name":"(anonymous_28)","decl":{"start":{"line":104,"column":73},"end":{"line":104,"column":74}},"loc":{"start":{"line":104,"column":79},"end":{"line":110,"column":6}},"line":104},"29":{"name":"(anonymous_29)","decl":{"start":{"line":104,"column":111},"end":{"line":104,"column":112}},"loc":{"start":{"line":104,"column":124},"end":{"line":110,"column":5}},"line":104},"30":{"name":"(anonymous_30)","decl":{"start":{"line":111,"column":71},"end":{"line":111,"column":72}},"loc":{"start":{"line":111,"column":77},"end":{"line":117,"column":6}},"line":111},"31":{"name":"(anonymous_31)","decl":{"start":{"line":111,"column":109},"end":{"line":111,"column":110}},"loc":{"start":{"line":111,"column":122},"end":{"line":117,"column":5}},"line":111},"32":{"name":"(anonymous_32)","decl":{"start":{"line":118,"column":76},"end":{"line":118,"column":77}},"loc":{"start":{"line":118,"column":82},"end":{"line":126,"column":6}},"line":118},"33":{"name":"(anonymous_33)","decl":{"start":{"line":118,"column":114},"end":{"line":118,"column":115}},"loc":{"start":{"line":118,"column":127},"end":{"line":126,"column":5}},"line":118},"34":{"name":"(anonymous_34)","decl":{"start":{"line":127,"column":39},"end":{"line":127,"column":40}},"loc":{"start":{"line":127,"column":45},"end":{"line":140,"column":6}},"line":127},"35":{"name":"(anonymous_35)","decl":{"start":{"line":127,"column":77},"end":{"line":127,"column":78}},"loc":{"start":{"line":127,"column":90},"end":{"line":140,"column":5}},"line":127},"36":{"name":"(anonymous_36)","decl":{"start":{"line":142,"column":38},"end":{"line":142,"column":39}},"loc":{"start":{"line":142,"column":44},"end":{"line":176,"column":1}},"line":142},"37":{"name":"(anonymous_37)","decl":{"start":{"line":143,"column":34},"end":{"line":143,"column":35}},"loc":{"start":{"line":143,"column":44},"end":{"line":175,"column":6}},"line":143},"38":{"name":"(anonymous_38)","decl":{"start":{"line":143,"column":76},"end":{"line":143,"column":77}},"loc":{"start":{"line":143,"column":89},"end":{"line":175,"column":5}},"line":143},"39":{"name":"(anonymous_39)","decl":{"start":{"line":177,"column":34},"end":{"line":177,"column":35}},"loc":{"start":{"line":177,"column":40},"end":{"line":210,"column":1}},"line":177},"40":{"name":"(anonymous_40)","decl":{"start":{"line":178,"column":37},"end":{"line":178,"column":38}},"loc":{"start":{"line":178,"column":43},"end":{"line":193,"column":6}},"line":178},"41":{"name":"(anonymous_41)","decl":{"start":{"line":178,"column":75},"end":{"line":178,"column":76}},"loc":{"start":{"line":178,"column":88},"end":{"line":193,"column":5}},"line":178},"42":{"name":"(anonymous_42)","decl":{"start":{"line":194,"column":25},"end":{"line":194,"column":26}},"loc":{"start":{"line":194,"column":31},"end":{"line":209,"column":6}},"line":194},"43":{"name":"(anonymous_43)","decl":{"start":{"line":194,"column":63},"end":{"line":194,"column":64}},"loc":{"start":{"line":194,"column":76},"end":{"line":209,"column":5}},"line":194},"44":{"name":"(anonymous_44)","decl":{"start":{"line":211,"column":43},"end":{"line":211,"column":44}},"loc":{"start":{"line":211,"column":49},"end":{"line":219,"column":1}},"line":211},"45":{"name":"(anonymous_45)","decl":{"start":{"line":212,"column":43},"end":{"line":212,"column":44}},"loc":{"start":{"line":212,"column":49},"end":{"line":218,"column":5}},"line":212},"46":{"name":"(anonymous_46)","decl":{"start":{"line":213,"column":59},"end":{"line":213,"column":60}},"loc":{"start":{"line":213,"column":70},"end":{"line":213,"column":78}},"line":213},"47":{"name":"(anonymous_47)","decl":{"start":{"line":215,"column":24},"end":{"line":215,"column":25}},"loc":{"start":{"line":215,"column":38},"end":{"line":215,"column":42}},"line":215},"48":{"name":"(anonymous_48)","decl":{"start":{"line":220,"column":35},"end":{"line":220,"column":36}},"loc":{"start":{"line":220,"column":41},"end":{"line":226,"column":1}},"line":220},"49":{"name":"(anonymous_49)","decl":{"start":{"line":221,"column":31},"end":{"line":221,"column":32}},"loc":{"start":{"line":221,"column":37},"end":{"line":225,"column":5}},"line":221},"50":{"name":"(anonymous_50)","decl":{"start":{"line":227,"column":37},"end":{"line":227,"column":38}},"loc":{"start":{"line":227,"column":43},"end":{"line":256,"column":1}},"line":227},"51":{"name":"(anonymous_51)","decl":{"start":{"line":228,"column":36},"end":{"line":228,"column":37}},"loc":{"start":{"line":228,"column":42},"end":{"line":237,"column":5}},"line":228},"52":{"name":"(anonymous_52)","decl":{"start":{"line":238,"column":38},"end":{"line":238,"column":39}},"loc":{"start":{"line":238,"column":44},"end":{"line":249,"column":5}},"line":238},"53":{"name":"(anonymous_53)","decl":{"start":{"line":250,"column":28},"end":{"line":250,"column":29}},"loc":{"start":{"line":250,"column":34},"end":{"line":255,"column":5}},"line":250}},"branchMap":{"0":{"loc":{"start":{"line":1,"column":16},"end":{"line":8,"column":1}},"type":"binary-expr","locations":[{"start":{"line":1,"column":17},"end":{"line":1,"column":21}},{"start":{"line":1,"column":25},"end":{"line":1,"column":39}},{"start":{"line":1,"column":44},"end":{"line":8,"column":1}}],"line":1},"1":{"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":34}},"type":"binary-expr","locations":[{"start":{"line":2,"column":16},"end":{"line":2,"column":17}},{"start":{"line":2,"column":22},"end":{"line":2,"column":33}}],"line":2},"2":{"loc":{"start":{"line":5,"column":32},"end":{"line":5,"column":148}},"type":"cond-expr","locations":[{"start":{"line":5,"column":46},"end":{"line":5,"column":67}},{"start":{"line":5,"column":70},"end":{"line":5,"column":148}}],"line":5},"3":{"loc":{"start":{"line":6,"column":51},"end":{"line":6,"column":67}},"type":"binary-expr","locations":[{"start":{"line":6,"column":51},"end":{"line":6,"column":61}},{"start":{"line":6,"column":65},"end":{"line":6,"column":67}}],"line":6}},"s":{"0":1,"1":10,"2":15,"3":15,"4":0,"5":0,"6":0,"7":0,"8":25,"9":15,"10":10,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":3,"52":1,"53":3,"54":1,"55":1,"56":1,"57":1,"58":1,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":4,"77":1,"78":4,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":1,"88":1,"89":1,"90":1,"91":1,"92":1,"93":1,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":1,"102":1,"103":1,"104":1,"105":1,"106":1,"107":1,"108":1,"109":1,"110":1,"111":1,"112":1,"113":1,"114":1,"115":1,"116":1,"117":1,"118":1,"119":1,"120":1,"121":1,"122":1,"123":1,"124":1,"125":1,"126":1,"127":1,"128":1,"129":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"136":1,"137":1,"138":1,"139":1,"140":1,"141":1,"142":1,"143":1,"144":1,"145":1,"146":1,"147":1,"148":1,"149":1,"150":1,"151":1,"152":1,"153":4,"154":1,"155":1,"156":4,"157":1,"158":1,"159":1,"160":1,"161":1,"162":1,"163":1,"164":1,"165":1,"166":1,"167":1,"168":1,"169":1,"170":1,"171":1,"172":1,"173":1,"174":1,"175":1,"176":1,"177":1,"178":1,"179":1},"f":{"0":10,"1":10,"2":15,"3":0,"4":25,"5":15,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":3,"18":3,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":4,"27":4,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":4,"47":4,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1},"b":{"0":[1,0,1],"1":[10,10],"2":[10,15],"3":[10,10]},"inputSourceMap":{"version":3,"file":"CompactdArtist.spec.js","sourceRoot":"","sources":["CompactdArtist.spec.tsx"],"names":[],"mappings":"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","sourcesContent":["import {} from 'jest';\r\nimport { CompactdArtist } from 'api/models/CompactdArtist';\r\nimport { Status, FindMode } from 'api/models/CompactdModel';\r\nimport pouch from 'pouchdb';\r\nimport fetch from 'node-fetch';\r\nimport * as sinon from 'sinon';\r\nimport { Artist } from 'definitions';\r\n\r\npouch.plugin(require('pouchdb-adapter-memory'));\r\nconst PouchDB = pouch.defaults({adapter: 'memory'})\r\n\r\nconst BoundArtist = CompactdArtist.bind(null, PouchDB, fetch as any);\r\nconst sandbox = sinon.createSandbox();\r\n\r\nconst delay = (ms: number) => {\r\n  return new Promise((resolve) => {\r\n    setTimeout(resolve, ms);\r\n  });\r\n}\r\n\r\ndescribe('CompactdArtist#constructor', () => {\r\n  \r\n  it ('creates a new database instance named `artist`', () => {\r\n    expect.assertions(2);\r\n    const pouch = sinon.spy(PouchDB);\r\n    const artist = new CompactdArtist(pouch as any, null, 'foo');\r\n    \r\n    expect(pouch.calledOnce).toBe(true);\r\n    expect(pouch.calledWithExactly('artists')).toBe(true);\r\n  });\r\n\r\n  it ('creates a barebone object when only id is passed', () => {\r\n    const artist = new BoundArtist('foo');\r\n\r\n    expect(artist.id).toBe('foo');\r\n    expect(artist.status).toBe(Status.BAREBONE);\r\n  });\r\n\r\n  it ('creates a fetched object when id and name is passed', () => {\r\n    const artist = new BoundArtist('foo', 'Foo');\r\n\r\n    expect(artist.id).toBe('foo');\r\n    expect(artist.name).toBe('Foo');\r\n    expect(artist.status).toBe(Status.FETCHED);\r\n  });\r\n\r\n  it ('copies props from other object when cloned', () => {\r\n    const artist = new BoundArtist('foo', 'Foo');\r\n    const other = new BoundArtist(artist);\r\n\r\n    expect(other.id).toBe('foo');\r\n    expect(other.name).toBe('Foo');\r\n    expect(other.status).toBe(Status.FETCHED);\r\n  });\r\n\r\n  it ('creates a fetched instance from props', () => {\r\n    const artist = new BoundArtist({name: 'Foo', '_id': 'foo'});\r\n    expect(artist.name).toBe('Foo');\r\n    expect(artist.id).toBe('foo');\r\n    expect(artist.status).toBe(Status.FETCHED);\r\n  });\r\n})\r\n\r\ndescribe('CompactdArtist#props', () => {\r\n  it ('returns an object with its props', () => {\r\n    const artist = new BoundArtist('foo', 'bar');\r\n    expect(artist.props).toEqual({_id: 'foo', name: 'bar'});\r\n  });\r\n});\r\n\r\ndescribe('CompactdArtist#pull', () => {\r\n  \r\n  let getStub: sinon.SinonStub;\r\n  beforeEach(() => {\r\n    getStub = sandbox.stub(PouchDB.prototype, 'get').returns(Promise.resolve({\r\n      name: 'Foobar',\r\n      _id: 'foobar'\r\n    }));\r\n  });\r\n  afterEach(() => {\r\n    sandbox.restore();\r\n  });\r\n  it('calls PouchDB#get', async () => {\r\n    expect.assertions(3);\r\n    const artist = new CompactdArtist(PouchDB, null, 'foo', 'bar');\r\n    await artist.pull();\r\n    expect(getStub.calledOnce).toBeTruthy();\r\n    expect(getStub.calledWithExactly(\"foo\")).toBeTruthy();\r\n    expect(artist.name).toBe(\"Foobar\");\r\n  });\r\n  it('populates props', async () => {\r\n    expect.assertions(1);\r\n    const artist = new CompactdArtist(PouchDB, null, 'foo', 'bar');\r\n    await artist.pull();\r\n    expect(artist.name).toBe('Foobar');\r\n  });\r\n  it('sets its status to fetched', async () => {\r\n    expect.assertions(1);\r\n    const artist = new CompactdArtist(PouchDB, null, 'foo', 'bar');\r\n    await artist.pull();\r\n    \r\n    expect(artist.status).toBe(Status.FETCHED);\r\n  });\r\n});\r\n\r\ndescribe('CompactdArtist.findAll', () => {\r\n\r\n  let allDocsStub: sinon.SinonStub;\r\n  beforeEach(() => {\r\n    allDocsStub = sandbox.stub(PouchDB.prototype, 'allDocs').resolves({\r\n      rows: []\r\n    });\r\n  });\r\n  afterEach(() => {\r\n    sandbox.restore();\r\n  });\r\n  it ('calls PouchDB#allDocs with include_docs = false whith BAREBONE', async () => {\r\n    expect.assertions(3);\r\n    const res = await CompactdArtist.findAll(PouchDB, null, FindMode.BAREBONE);\r\n    \r\n    expect(res).toEqual([]);\r\n    expect(allDocsStub.calledOnce).toBe(true);\r\n    expect(allDocsStub.calledWith({include_docs: false})).toBe(true);\r\n  });\r\n  it ('calls PouchDB#allDocs with include_docs = true with PREFETCH', async () => {\r\n    expect.assertions(3);\r\n    const res = await CompactdArtist.findAll(PouchDB, null, FindMode.PREFETCH);\r\n    \r\n    expect(res).toEqual([]);\r\n    expect(allDocsStub.calledOnce).toBe(true);\r\n    expect(allDocsStub.calledWith({include_docs: true})).toBe(true);\r\n  });\r\n  it ('calls PouchDB#allDocs with startkey and endkey when key is passed', async () => {\r\n    expect.assertions(3);\r\n    const res = await CompactdArtist.findAll(PouchDB, null, FindMode.PREFETCH, 'foobar');\r\n    \r\n    expect(res).toEqual([]);\r\n    expect(allDocsStub.calledOnce).toBe(true);\r\n    expect(allDocsStub.calledWith({\r\n      include_docs: true, startkey: 'foobar', endkey: 'foobar\\uffff'})).toBe(true);\r\n  });\r\n  it ('maps each row with an artist', async () => {\r\n    expect.assertions(5);\r\n\r\n    allDocsStub.returns({\r\n      rows: [{id: 'foo'}, {id: 'bar'}]\r\n    });\r\n\r\n    const res = await CompactdArtist.findAll(PouchDB, null, FindMode.PREFETCH, 'foobar');\r\n    \r\n    expect(res.length).toBe(2);\r\n    expect(res[0].id).toBe('foo');\r\n    expect(res[1].id).toBe('bar');\r\n    expect(allDocsStub.calledOnce).toBe(true);\r\n    expect(allDocsStub.calledWith({\r\n      include_docs: true, startkey: 'foobar', endkey: 'foobar\\uffff'})).toBe(true);\r\n  });\r\n});\r\n\r\ndescribe('CompactdArtist#detachFeed', () => {\r\n  it ('doesnt fire once called', async (done) => {\r\n    expect.assertions(1);\r\n\r\n    const artists = new PouchDB(CompactdArtist.DATABASE_NAME);\r\n    const fz = await artists.put({\r\n      _id: 'library/flatbush-zombies',\r\n      name: 'Flatbush ZOMBiES'\r\n    });\r\n    const id = 'library/flatbush-zombies';\r\n    const flatbush = new CompactdArtist(PouchDB, null, id);\r\n    let rev: string = null;\r\n    await flatbush.fetch();\r\n\r\n    const stub = sinon.stub();\r\n\r\n    const unbinder = flatbush.addOnPropsChangedListener(stub);\r\n    const res = await artists.put({\r\n      _rev: fz.rev,\r\n      _id: id,\r\n      name: 'Flatbush Zombies'\r\n    });\r\n    await delay(15);\r\n    unbinder.unbind();\r\n\r\n    const res2 = await artists.put({\r\n      _rev: res.rev,\r\n      _id: id,\r\n      name: 'Flatbush ZOMBIES'\r\n    });\r\n\r\n    await artists.put({\r\n      _rev: res2.rev,\r\n      _id: id,\r\n      name: 'Flatbush ZombiES'\r\n    });\r\n\r\n    expect(stub.calledOnce).toBe(true);\r\n\r\n    done();\r\n  });\r\n});\r\n\r\ndescribe ('CompactdArtist.create', () => {\r\n  it('calls put with id and name', async () => {\r\n    let putStub = sandbox.stub(PouchDB.prototype, 'put').resolves({});\r\n    let getStub = sandbox.stub(PouchDB.prototype, 'get').resolves({\r\n      _id: 'library/foo',\r\n      name: 'foo'\r\n    });\r\n    \r\n    const foo = await CompactdArtist.create(PouchDB, null, 'foo');\r\n\r\n    expect(foo.name).toBe('foo');\r\n    expect(foo.id).toBe('library/foo');\r\n\r\n    expect(putStub.calledOnce).toBe(true);\r\n    expect(putStub.calledWith({\r\n      _id: 'library/foo',\r\n      name: 'foo'\r\n    }));\r\n\r\n    sandbox.restore();\r\n  });\r\n\r\n  \r\n  it('slugifies name', async () => {\r\n    let putStub = sandbox.stub(PouchDB.prototype, 'put').resolves({});\r\n    let getStub = sandbox.stub(PouchDB.prototype, 'get').resolves({\r\n      _id: 'library/foo-heavy-heart-trees-and-salad',\r\n      name: 'foo  trees & salad'\r\n    });\r\n    \r\n    const foo = await CompactdArtist.create(PouchDB, null, 'foo');\r\n\r\n    expect(foo.name).toBe('foo');\r\n    expect(foo.id).toBe('library/foo');\r\n\r\n    expect(putStub.calledOnce).toBe(true);\r\n    expect(putStub.calledWith({\r\n      _id: 'library/foo-heavy-heart-trees-and-salad',\r\n      name: 'foo  trees & salad'\r\n    }));\r\n\r\n    sandbox.restore();\r\n  });\r\n});\r\n\r\ndescribe ('CompactdArtist.byNameAscending', () => {\r\n  it('sorts an array by name ascending', () => {\r\n    const docs = ['foo', 'bar', 'zzrot', 'foobar'].map((name) => ({name}));\r\n\r\n    const res = docs.sort(CompactdArtist.byNameAscending);\r\n\r\n    expect(docs.map(({name}) => name)).toEqual([\r\n      'bar', 'foo', 'foobar', 'zzrot'\r\n    ]);\r\n  });\r\n});\r\n\r\ndescribe ('CompactdArtist.toProps', () => {\r\n  it ('maps models to props', () => {\r\n    const props = {foo: 'bar'};\r\n    const res = CompactdArtist.toProps()({props} as any);\r\n    expect(props).toEqual(res);\r\n  });\r\n});\r\n\r\ndescribe ('CompactdArtist.fromProps', () => {\r\n  it ('maps flat props to models', () => {\r\n    const props = {\r\n      _id: 'foo',\r\n      name: 'bar'\r\n    };\r\n\r\n    const foo = CompactdArtist.fromProps(PouchDB, null)(props);\r\n\r\n    expect(foo.id).toBe('foo');\r\n    expect(foo.name).toBe('bar');\r\n    expect(foo).toBeInstanceOf(CompactdArtist);\r\n  });\r\n  it ('maps nested props to models', () => {\r\n    const props = {\r\n      _id: 'foo',\r\n      name: 'bar'\r\n    };\r\n\r\n    const foo = CompactdArtist.fromProps(PouchDB, null)({\r\n      doc: props, id: 'foo'});\r\n\r\n    expect(foo.id).toBe('foo');\r\n    expect(foo.name).toBe('bar');\r\n    expect(foo).toBeInstanceOf(CompactdArtist);\r\n  });\r\n  it ('maps id to models', () => {\r\n\r\n    const foo = CompactdArtist.fromProps(PouchDB, null)({id: 'foo'});\r\n\r\n    expect(foo.id).toBe('foo');\r\n    expect(foo.name).toBe(null);\r\n    expect(foo).toBeInstanceOf(CompactdArtist);\r\n  });\r\n});\r\n"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"dfd3854341b444328ab02106323a0bdf8bb223b3"}
,"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\models\\CompactdArtist.tsx": {"path":"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\models\\CompactdArtist.tsx","statementMap":{"0":{"start":{"line":1,"column":16},"end":{"line":8,"column":1}},"1":{"start":{"line":2,"column":4},"end":{"line":7,"column":7}},"2":{"start":{"line":3,"column":36},"end":{"line":3,"column":97}},"3":{"start":{"line":3,"column":42},"end":{"line":3,"column":70}},"4":{"start":{"line":3,"column":85},"end":{"line":3,"column":95}},"5":{"start":{"line":4,"column":35},"end":{"line":4,"column":100}},"6":{"start":{"line":4,"column":41},"end":{"line":4,"column":73}},"7":{"start":{"line":4,"column":88},"end":{"line":4,"column":98}},"8":{"start":{"line":5,"column":32},"end":{"line":5,"column":149}},"9":{"start":{"line":5,"column":97},"end":{"line":5,"column":119}},"10":{"start":{"line":6,"column":8},"end":{"line":6,"column":78}},"11":{"start":{"line":14,"column":8},"end":{"line":25,"column":9}},"12":{"start":{"line":15,"column":12},"end":{"line":15,"column":111}},"13":{"start":{"line":16,"column":12},"end":{"line":16,"column":30}},"14":{"start":{"line":18,"column":13},"end":{"line":25,"column":9}},"15":{"start":{"line":19,"column":12},"end":{"line":19,"column":85}},"16":{"start":{"line":20,"column":12},"end":{"line":20,"column":34}},"17":{"start":{"line":22,"column":13},"end":{"line":25,"column":9}},"18":{"start":{"line":23,"column":12},"end":{"line":23,"column":89}},"19":{"start":{"line":24,"column":12},"end":{"line":24,"column":33}},"20":{"start":{"line":28,"column":8},"end":{"line":28,"column":67}},"21":{"start":{"line":28,"column":57},"end":{"line":28,"column":65}},"22":{"start":{"line":34,"column":8},"end":{"line":34,"column":26}},"23":{"start":{"line":37,"column":8},"end":{"line":40,"column":10}},"24":{"start":{"line":43,"column":8},"end":{"line":46,"column":11}},"25":{"start":{"line":44,"column":26},"end":{"line":44,"column":59}},"26":{"start":{"line":45,"column":12},"end":{"line":45,"column":36}},"27":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"28":{"start":{"line":50,"column":12},"end":{"line":50,"column":85}},"29":{"start":{"line":52,"column":8},"end":{"line":52,"column":81}},"30":{"start":{"line":62,"column":8},"end":{"line":71,"column":11}},"31":{"start":{"line":63,"column":28},"end":{"line":63,"column":69}},"32":{"start":{"line":64,"column":26},"end":{"line":69,"column":20}},"33":{"start":{"line":70,"column":12},"end":{"line":70,"column":72}},"34":{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},"35":{"start":{"line":75,"column":12},"end":{"line":75,"column":19}},"36":{"start":{"line":77,"column":8},"end":{"line":95,"column":11}},"37":{"start":{"line":83,"column":12},"end":{"line":87,"column":13}},"38":{"start":{"line":84,"column":16},"end":{"line":84,"column":46}},"39":{"start":{"line":85,"column":16},"end":{"line":85,"column":38}},"40":{"start":{"line":86,"column":16},"end":{"line":86,"column":23}},"41":{"start":{"line":88,"column":12},"end":{"line":93,"column":13}},"42":{"start":{"line":89,"column":30},"end":{"line":89,"column":40}},"43":{"start":{"line":90,"column":16},"end":{"line":90,"column":38}},"44":{"start":{"line":91,"column":16},"end":{"line":91,"column":60}},"45":{"start":{"line":92,"column":16},"end":{"line":92,"column":23}},"46":{"start":{"line":94,"column":12},"end":{"line":94,"column":59}},"47":{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},"48":{"start":{"line":99,"column":12},"end":{"line":99,"column":35}},"49":{"start":{"line":103,"column":8},"end":{"line":103,"column":51}},"50":{"start":{"line":112,"column":19},"end":{"line":112,"column":58}},"51":{"start":{"line":113,"column":20},"end":{"line":113,"column":58}},"52":{"start":{"line":114,"column":8},"end":{"line":116,"column":11}},"53":{"start":{"line":115,"column":12},"end":{"line":115,"column":64}},"54":{"start":{"line":124,"column":8},"end":{"line":125,"column":22}},"55":{"start":{"line":125,"column":12},"end":{"line":125,"column":22}},"56":{"start":{"line":126,"column":8},"end":{"line":127,"column":21}},"57":{"start":{"line":127,"column":12},"end":{"line":127,"column":21}},"58":{"start":{"line":128,"column":8},"end":{"line":128,"column":17}},"59":{"start":{"line":134,"column":8},"end":{"line":136,"column":10}},"60":{"start":{"line":135,"column":12},"end":{"line":135,"column":30}},"61":{"start":{"line":144,"column":8},"end":{"line":149,"column":10}},"62":{"start":{"line":145,"column":12},"end":{"line":147,"column":13}},"63":{"start":{"line":146,"column":16},"end":{"line":146,"column":102}},"64":{"start":{"line":148,"column":12},"end":{"line":148,"column":60}},"65":{"start":{"line":152,"column":0},"end":{"line":152,"column":41}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":1,"column":44},"end":{"line":1,"column":45}},"loc":{"start":{"line":1,"column":89},"end":{"line":8,"column":1}},"line":1},"1":{"name":"(anonymous_1)","decl":{"start":{"line":2,"column":36},"end":{"line":2,"column":37}},"loc":{"start":{"line":2,"column":63},"end":{"line":7,"column":5}},"line":2},"2":{"name":"fulfilled","decl":{"start":{"line":3,"column":17},"end":{"line":3,"column":26}},"loc":{"start":{"line":3,"column":34},"end":{"line":3,"column":99}},"line":3},"3":{"name":"rejected","decl":{"start":{"line":4,"column":17},"end":{"line":4,"column":25}},"loc":{"start":{"line":4,"column":33},"end":{"line":4,"column":102}},"line":4},"4":{"name":"step","decl":{"start":{"line":5,"column":17},"end":{"line":5,"column":21}},"loc":{"start":{"line":5,"column":30},"end":{"line":5,"column":151}},"line":5},"5":{"name":"(anonymous_5)","decl":{"start":{"line":5,"column":76},"end":{"line":5,"column":77}},"loc":{"start":{"line":5,"column":95},"end":{"line":5,"column":121}},"line":5},"6":{"name":"(anonymous_6)","decl":{"start":{"line":13,"column":4},"end":{"line":13,"column":5}},"loc":{"start":{"line":13,"column":43},"end":{"line":26,"column":5}},"line":13},"7":{"name":"(anonymous_7)","decl":{"start":{"line":27,"column":4},"end":{"line":27,"column":5}},"loc":{"start":{"line":27,"column":18},"end":{"line":29,"column":5}},"line":27},"8":{"name":"(anonymous_8)","decl":{"start":{"line":28,"column":48},"end":{"line":28,"column":49}},"loc":{"start":{"line":28,"column":57},"end":{"line":28,"column":65}},"line":28},"9":{"name":"(anonymous_9)","decl":{"start":{"line":33,"column":4},"end":{"line":33,"column":5}},"loc":{"start":{"line":33,"column":15},"end":{"line":35,"column":5}},"line":33},"10":{"name":"(anonymous_10)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":16},"end":{"line":41,"column":5}},"line":36},"11":{"name":"(anonymous_11)","decl":{"start":{"line":42,"column":4},"end":{"line":42,"column":5}},"loc":{"start":{"line":42,"column":11},"end":{"line":47,"column":5}},"line":42},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":47},"end":{"line":43,"column":48}},"loc":{"start":{"line":43,"column":60},"end":{"line":46,"column":9}},"line":43},"13":{"name":"(anonymous_13)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":28},"end":{"line":53,"column":5}},"line":48},"14":{"name":"(anonymous_14)","decl":{"start":{"line":61,"column":4},"end":{"line":61,"column":5}},"loc":{"start":{"line":61,"column":42},"end":{"line":72,"column":5}},"line":61},"15":{"name":"(anonymous_15)","decl":{"start":{"line":62,"column":47},"end":{"line":62,"column":48}},"loc":{"start":{"line":62,"column":60},"end":{"line":71,"column":9}},"line":62},"16":{"name":"(anonymous_16)","decl":{"start":{"line":73,"column":4},"end":{"line":73,"column":5}},"loc":{"start":{"line":73,"column":17},"end":{"line":96,"column":5}},"line":73},"17":{"name":"(anonymous_17)","decl":{"start":{"line":82,"column":24},"end":{"line":82,"column":25}},"loc":{"start":{"line":82,"column":50},"end":{"line":95,"column":9}},"line":82},"18":{"name":"(anonymous_18)","decl":{"start":{"line":97,"column":4},"end":{"line":97,"column":5}},"loc":{"start":{"line":97,"column":17},"end":{"line":101,"column":5}},"line":97},"19":{"name":"(anonymous_19)","decl":{"start":{"line":102,"column":4},"end":{"line":102,"column":5}},"loc":{"start":{"line":102,"column":13},"end":{"line":104,"column":5}},"line":102},"20":{"name":"(anonymous_20)","decl":{"start":{"line":111,"column":4},"end":{"line":111,"column":5}},"loc":{"start":{"line":111,"column":39},"end":{"line":117,"column":5}},"line":111},"21":{"name":"(anonymous_21)","decl":{"start":{"line":114,"column":42},"end":{"line":114,"column":43}},"loc":{"start":{"line":114,"column":48},"end":{"line":116,"column":9}},"line":114},"22":{"name":"(anonymous_22)","decl":{"start":{"line":123,"column":4},"end":{"line":123,"column":5}},"loc":{"start":{"line":123,"column":33},"end":{"line":129,"column":5}},"line":123},"23":{"name":"(anonymous_23)","decl":{"start":{"line":133,"column":4},"end":{"line":133,"column":5}},"loc":{"start":{"line":133,"column":21},"end":{"line":137,"column":5}},"line":133},"24":{"name":"(anonymous_24)","decl":{"start":{"line":134,"column":15},"end":{"line":134,"column":16}},"loc":{"start":{"line":134,"column":25},"end":{"line":136,"column":9}},"line":134},"25":{"name":"(anonymous_25)","decl":{"start":{"line":143,"column":4},"end":{"line":143,"column":5}},"loc":{"start":{"line":143,"column":36},"end":{"line":150,"column":5}},"line":143},"26":{"name":"(anonymous_26)","decl":{"start":{"line":144,"column":15},"end":{"line":144,"column":16}},"loc":{"start":{"line":144,"column":26},"end":{"line":149,"column":9}},"line":144}},"branchMap":{"0":{"loc":{"start":{"line":1,"column":16},"end":{"line":8,"column":1}},"type":"binary-expr","locations":[{"start":{"line":1,"column":17},"end":{"line":1,"column":21}},{"start":{"line":1,"column":25},"end":{"line":1,"column":39}},{"start":{"line":1,"column":44},"end":{"line":8,"column":1}}],"line":1},"1":{"loc":{"start":{"line":2,"column":16},"end":{"line":2,"column":34}},"type":"binary-expr","locations":[{"start":{"line":2,"column":16},"end":{"line":2,"column":17}},{"start":{"line":2,"column":22},"end":{"line":2,"column":33}}],"line":2},"2":{"loc":{"start":{"line":5,"column":32},"end":{"line":5,"column":148}},"type":"cond-expr","locations":[{"start":{"line":5,"column":46},"end":{"line":5,"column":67}},{"start":{"line":5,"column":70},"end":{"line":5,"column":148}}],"line":5},"3":{"loc":{"start":{"line":6,"column":51},"end":{"line":6,"column":67}},"type":"binary-expr","locations":[{"start":{"line":6,"column":51},"end":{"line":6,"column":61}},{"start":{"line":6,"column":65},"end":{"line":6,"column":67}}],"line":6},"4":{"loc":{"start":{"line":14,"column":8},"end":{"line":25,"column":9}},"type":"if","locations":[{"start":{"line":14,"column":8},"end":{"line":25,"column":9}},{"start":{"line":14,"column":8},"end":{"line":25,"column":9}}],"line":14},"5":{"loc":{"start":{"line":15,"column":69},"end":{"line":15,"column":109}},"type":"cond-expr","locations":[{"start":{"line":15,"column":77},"end":{"line":15,"column":92}},{"start":{"line":15,"column":95},"end":{"line":15,"column":109}}],"line":15},"6":{"loc":{"start":{"line":18,"column":13},"end":{"line":25,"column":9}},"type":"if","locations":[{"start":{"line":18,"column":13},"end":{"line":25,"column":9}},{"start":{"line":18,"column":13},"end":{"line":25,"column":9}}],"line":18},"7":{"loc":{"start":{"line":22,"column":13},"end":{"line":25,"column":9}},"type":"if","locations":[{"start":{"line":22,"column":13},"end":{"line":25,"column":9}},{"start":{"line":22,"column":13},"end":{"line":25,"column":9}}],"line":22},"8":{"loc":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},{"start":{"line":49,"column":8},"end":{"line":51,"column":9}}],"line":49},"9":{"loc":{"start":{"line":66,"column":15},"end":{"line":69,"column":18}},"type":"cond-expr","locations":[{"start":{"line":66,"column":21},"end":{"line":69,"column":13}},{"start":{"line":69,"column":16},"end":{"line":69,"column":18}}],"line":66},"10":{"loc":{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},"type":"if","locations":[{"start":{"line":74,"column":8},"end":{"line":76,"column":9}},{"start":{"line":74,"column":8},"end":{"line":76,"column":9}}],"line":74},"11":{"loc":{"start":{"line":83,"column":12},"end":{"line":87,"column":13}},"type":"if","locations":[{"start":{"line":83,"column":12},"end":{"line":87,"column":13}},{"start":{"line":83,"column":12},"end":{"line":87,"column":13}}],"line":83},"12":{"loc":{"start":{"line":88,"column":12},"end":{"line":93,"column":13}},"type":"if","locations":[{"start":{"line":88,"column":12},"end":{"line":93,"column":13}},{"start":{"line":88,"column":12},"end":{"line":93,"column":13}}],"line":88},"13":{"loc":{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},"type":"if","locations":[{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},{"start":{"line":98,"column":8},"end":{"line":100,"column":9}}],"line":98},"14":{"loc":{"start":{"line":124,"column":8},"end":{"line":125,"column":22}},"type":"if","locations":[{"start":{"line":124,"column":8},"end":{"line":125,"column":22}},{"start":{"line":124,"column":8},"end":{"line":125,"column":22}}],"line":124},"15":{"loc":{"start":{"line":126,"column":8},"end":{"line":127,"column":21}},"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":127,"column":21}},{"start":{"line":126,"column":8},"end":{"line":127,"column":21}}],"line":126},"16":{"loc":{"start":{"line":145,"column":12},"end":{"line":147,"column":13}},"type":"if","locations":[{"start":{"line":145,"column":12},"end":{"line":147,"column":13}},{"start":{"line":145,"column":12},"end":{"line":147,"column":13}}],"line":145},"17":{"loc":{"start":{"line":146,"column":67},"end":{"line":146,"column":100}},"type":"cond-expr","locations":[{"start":{"line":146,"column":79},"end":{"line":146,"column":93}},{"start":{"line":146,"column":96},"end":{"line":146,"column":100}}],"line":146}},"s":{"0":1,"1":8,"2":8,"3":8,"4":0,"5":0,"6":0,"7":0,"8":16,"9":8,"10":8,"11":18,"12":15,"13":15,"14":3,"15":1,"16":1,"17":2,"18":2,"19":2,"20":0,"21":0,"22":10,"23":2,"24":4,"25":4,"26":4,"27":0,"28":0,"29":0,"30":4,"31":4,"32":4,"33":4,"34":1,"35":0,"36":1,"37":1,"38":0,"39":0,"40":0,"41":1,"42":1,"43":1,"44":1,"45":1,"46":0,"47":1,"48":1,"49":0,"50":2,"51":2,"52":2,"53":2,"54":4,"55":2,"56":2,"57":2,"58":0,"59":1,"60":1,"61":7,"62":5,"63":4,"64":1,"65":1},"f":{"0":8,"1":8,"2":8,"3":0,"4":16,"5":8,"6":18,"7":0,"8":0,"9":10,"10":2,"11":4,"12":4,"13":0,"14":4,"15":4,"16":1,"17":1,"18":1,"19":0,"20":2,"21":2,"22":4,"23":1,"24":1,"25":7,"26":5},"b":{"0":[1,0,1],"1":[8,8],"2":[8,8],"3":[8,8],"4":[15,3],"5":[6,9],"6":[1,2],"7":[2,0],"8":[0,0],"9":[2,2],"10":[0,1],"11":[0,1],"12":[1,0],"13":[1,0],"14":[2,2],"15":[2,0],"16":[4,1],"17":[1,3]},"inputSourceMap":{"version":3,"file":"CompactdArtist.js","sourceRoot":"","sources":["CompactdArtist.tsx"],"names":[],"mappings":"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","sourcesContent":["import { CompactdModel, Status, FindMode } from \"api/models/CompactdModel\";\r\nimport { Artist, artistURI, mapArtistToParams } from \"compactd-models\";\r\nimport Map from 'models/Map';\r\nimport Artwork from \"api/Artwork\";\r\n\r\nexport class CompactdArtist extends CompactdModel<Artist> {\r\n  public static readonly DATABASE_NAME = \"artists\";\r\n\r\n  private _changes: PouchDB.Core.Changes<Artist>;\r\n  private _name: string;\r\n\r\n  /**\r\n   * Copy constructor\r\n   * @param pouchdb the pouchdb constructor\r\n   * @param _fetch the fetch fucntion\r\n   * @param model the otehr model\r\n   */\r\n  public constructor (pouchdb: PouchDB.Static, _fetch: typeof fetch, model: CompactdArtist)\r\n  /**\r\n   * Constructe from props object\r\n   * @param pouchdb \r\n   * @param _fetch \r\n   * @param props\r\n   */\r\n  public constructor (pouchdb: PouchDB.Static, _fetch: typeof fetch, props: Artist)\r\n  public constructor (pouchdb: PouchDB.Static, _fetch: typeof fetch, id: string, name?: string)\r\n  public constructor (pouchdb: PouchDB.Static, _fetch: typeof fetch, id: string | Artist | CompactdArtist, name?: string) {\r\n    if (typeof id === 'string') {\r\n      super(pouchdb, _fetch, CompactdArtist.DATABASE_NAME, id, !name ?  Status.BAREBONE : Status.FETCHED);\r\n      this._name = name;\r\n    } else if (id instanceof CompactdArtist) {\r\n      super(pouchdb, _fetch, CompactdArtist.DATABASE_NAME, id._id, id._status);\r\n      this._name = id._name;\r\n    } else if (typeof id === 'object') {\r\n      super(pouchdb, _fetch, CompactdArtist.DATABASE_NAME, id._id,  Status.FETCHED);\r\n      this._name = id.name;\r\n    }\r\n  }\r\n  public getRevision () {\r\n    return this.database.get(this._id).then((doc) => doc._rev);\r\n  }\r\n  /**\r\n   * Artist name\r\n   */\r\n  public get name () {\r\n    return this._name;\r\n  }\r\n\r\n  public get props (): Artist {\r\n    return {\r\n      _id: this._id,\r\n      name: this._name\r\n    }\r\n  }\r\n\r\n  public async pull(): Promise<void> {\r\n    const props = await this.database.get(this._id);\r\n    \r\n    this._name = props.name;\r\n  }\r\n\r\n  public loadArtworkInto (target: HTMLImageElement) {\r\n    if (target.getBoundingClientRect().width <= 64) {\r\n      return Artwork.getInstance(this.pouchdb).load(this._id, 'small', target);\r\n    }\r\n    return Artwork.getInstance(this.pouchdb).load(this._id, 'large', target);\r\n  }\r\n\r\n  /**\r\n   * Find all artists\r\n   * @param pouchDB the pouchDB constructor to use\r\n   * @param f the fetch function to use\r\n   * @param mode the find mode\r\n   * @param key (optionnal) the starting key\r\n   */\r\n  public static async findAll (pouchDB: PouchDB.Static, f: typeof fetch, mode: FindMode, key?: string): Promise<CompactdArtist[]> {\r\n    const artists = new pouchDB<Artist>(CompactdArtist.DATABASE_NAME);\r\n\r\n    const items = await artists.allDocs(Object.assign({\r\n      include_docs: mode === FindMode.PREFETCH\r\n    }, key ? {\r\n      startkey: key,\r\n      endkey: key + '\\uffff'\r\n    } : {}));\r\n\r\n    return items.rows.map(CompactdArtist.fromProps(pouchDB, f));\r\n  }\r\n  \r\n  protected attachFeed(): void {\r\n    if (this._changes) {\r\n      return;\r\n    }\r\n    this._changes = this.database.changes({\r\n      since: 'now',\r\n      live: true,\r\n      include_docs: true,\r\n      doc_ids: [this._id]\r\n    }).on('change', ({doc, deleted, id}) => {\r\n      if (deleted) {\r\n        this._status = Status.DELETED;\r\n        this.fireOnDelete(id);\r\n        return;\r\n      }\r\n\r\n      if (doc.name !== this._name) {\r\n        const props = this.props;\r\n        this._name = doc.name;\r\n        this.fireOnPropsChanged('name', doc, props);\r\n        return;\r\n      }\r\n      \r\n      console.log('Unable to see change', arguments);\r\n    })\r\n  }\r\n\r\n  protected detachFeed(): void {\r\n    if (this._changes) {\r\n      this._changes.cancel();\r\n    }\r\n  }\r\n\r\n  public delete(): Promise<void> {\r\n    throw new Error(\"Method not implemented.\");\r\n  }\r\n\r\n  /**\r\n   * Creates a new database entity\r\n   * @param pouch the database to use\r\n   * @param _fetch the fetch function\r\n   * @param name the name of the artist, unslugified\r\n   */\r\n  public static create (pouch: PouchDB.Static, _fetch: typeof fetch, name: string) {\r\n    const db = new pouch(CompactdArtist.DATABASE_NAME);\r\n\r\n    const _id = artistURI(mapArtistToParams({name}));\r\n\r\n    return db.put({_id, name}).then(() => {\r\n      return new CompactdArtist(pouch, _fetch, _id, name);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * helper function to sort by name\r\n   * @param a \r\n   * @param b \r\n   */\r\n  public static byNameAscending (a: {name: string}, b: {name: string}) {\r\n    if(a.name < b.name) return -1;\r\n    if(a.name > b.name) return 1;\r\n    return 0;\r\n  }\r\n\r\n  /**\r\n   * Helper to map artists to their props\r\n   */\r\n  public static toProps () {\r\n    return (item: CompactdArtist) => {\r\n      return item.props;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Helper to map props to artist\r\n   * @param pouch pouchDB constructor\r\n   * @param _fetch fethc function\r\n   */\r\n  public static fromProps (pouch: PouchDB.Static, _fetch: typeof fetch) {\r\n    return (props: Artist | {doc?: Artist, id: string}) => {\r\n      if ((props as any).id) {\r\n        return new CompactdArtist(pouch, _fetch, (props as any).id, (props as any).doc ? (props as any).doc.name : null);\r\n      }\r\n      return new CompactdArtist(pouch, _fetch, props as Artist);\r\n    }\r\n  }\r\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"6f2101a6e74344926ed8899d681b10cceb7b7c8b"}
,"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\models\\CompactdModel.tsx": {"path":"C:\\Users\\Vincent\\Documents\\GitHub\\compactd\\client\\src\\api\\models\\CompactdModel.tsx","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":8,"column":28}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":48}},"2":{"start":{"line":4,"column":4},"end":{"line":4,"column":52}},"3":{"start":{"line":5,"column":4},"end":{"line":5,"column":46}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":46}},"5":{"start":{"line":7,"column":4},"end":{"line":7,"column":50}},"6":{"start":{"line":10,"column":0},"end":{"line":14,"column":32}},"7":{"start":{"line":11,"column":4},"end":{"line":11,"column":46}},"8":{"start":{"line":12,"column":4},"end":{"line":12,"column":52}},"9":{"start":{"line":13,"column":4},"end":{"line":13,"column":52}},"10":{"start":{"line":17,"column":8},"end":{"line":17,"column":28}},"11":{"start":{"line":18,"column":8},"end":{"line":18,"column":24}},"12":{"start":{"line":19,"column":8},"end":{"line":19,"column":22}},"13":{"start":{"line":20,"column":8},"end":{"line":20,"column":30}},"14":{"start":{"line":21,"column":8},"end":{"line":21,"column":29}},"15":{"start":{"line":22,"column":8},"end":{"line":22,"column":41}},"16":{"start":{"line":25,"column":8},"end":{"line":25,"column":24}},"17":{"start":{"line":28,"column":8},"end":{"line":28,"column":26}},"18":{"start":{"line":31,"column":8},"end":{"line":31,"column":28}},"19":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"20":{"start":{"line":35,"column":12},"end":{"line":35,"column":19}},"21":{"start":{"line":37,"column":8},"end":{"line":39,"column":11}},"22":{"start":{"line":38,"column":12},"end":{"line":38,"column":42}},"23":{"start":{"line":42,"column":20},"end":{"line":42,"column":30}},"24":{"start":{"line":43,"column":8},"end":{"line":43,"column":39}},"25":{"start":{"line":44,"column":8},"end":{"line":44,"column":26}},"26":{"start":{"line":45,"column":8},"end":{"line":54,"column":10}},"27":{"start":{"line":47,"column":16},"end":{"line":49,"column":17}},"28":{"start":{"line":48,"column":20},"end":{"line":48,"column":47}},"29":{"start":{"line":50,"column":16},"end":{"line":52,"column":17}},"30":{"start":{"line":51,"column":20},"end":{"line":51,"column":38}},"31":{"start":{"line":98,"column":8},"end":{"line":101,"column":11}},"32":{"start":{"line":104,"column":8},"end":{"line":106,"column":11}},"33":{"start":{"line":105,"column":12},"end":{"line":105,"column":34}},"34":{"start":{"line":109,"column":8},"end":{"line":111,"column":11}},"35":{"start":{"line":110,"column":12},"end":{"line":110,"column":66}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":1},"end":{"line":2,"column":2}},"loc":{"start":{"line":2,"column":19},"end":{"line":8,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":1},"end":{"line":10,"column":2}},"loc":{"start":{"line":10,"column":21},"end":{"line":14,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":45},"end":{"line":23,"column":5}},"line":16},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":13},"end":{"line":26,"column":5}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":27,"column":4},"end":{"line":27,"column":5}},"loc":{"start":{"line":27,"column":15},"end":{"line":29,"column":5}},"line":27},"5":{"name":"(anonymous_5)","decl":{"start":{"line":30,"column":4},"end":{"line":30,"column":5}},"loc":{"start":{"line":30,"column":17},"end":{"line":32,"column":5}},"line":30},"6":{"name":"(anonymous_6)","decl":{"start":{"line":33,"column":4},"end":{"line":33,"column":5}},"loc":{"start":{"line":33,"column":12},"end":{"line":40,"column":5}},"line":33},"7":{"name":"(anonymous_7)","decl":{"start":{"line":37,"column":32},"end":{"line":37,"column":33}},"loc":{"start":{"line":37,"column":38},"end":{"line":39,"column":9}},"line":37},"8":{"name":"(anonymous_8)","decl":{"start":{"line":41,"column":4},"end":{"line":41,"column":5}},"loc":{"start":{"line":41,"column":31},"end":{"line":55,"column":5}},"line":41},"9":{"name":"(anonymous_9)","decl":{"start":{"line":46,"column":20},"end":{"line":46,"column":21}},"loc":{"start":{"line":46,"column":26},"end":{"line":53,"column":13}},"line":46},"10":{"name":"(anonymous_10)","decl":{"start":{"line":97,"column":4},"end":{"line":97,"column":5}},"loc":{"start":{"line":97,"column":40},"end":{"line":102,"column":5}},"line":97},"11":{"name":"(anonymous_11)","decl":{"start":{"line":100,"column":22},"end":{"line":100,"column":23}},"loc":{"start":{"line":100,"column":28},"end":{"line":100,"column":31}},"line":100},"12":{"name":"(anonymous_12)","decl":{"start":{"line":103,"column":4},"end":{"line":103,"column":5}},"loc":{"start":{"line":103,"column":21},"end":{"line":107,"column":5}},"line":103},"13":{"name":"(anonymous_13)","decl":{"start":{"line":104,"column":46},"end":{"line":104,"column":47}},"loc":{"start":{"line":104,"column":60},"end":{"line":106,"column":9}},"line":104},"14":{"name":"(anonymous_14)","decl":{"start":{"line":108,"column":4},"end":{"line":108,"column":5}},"loc":{"start":{"line":108,"column":53},"end":{"line":112,"column":5}},"line":108},"15":{"name":"(anonymous_15)","decl":{"start":{"line":109,"column":46},"end":{"line":109,"column":47}},"loc":{"start":{"line":109,"column":60},"end":{"line":111,"column":9}},"line":109}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":3},"end":{"line":8,"column":26}},"type":"binary-expr","locations":[{"start":{"line":8,"column":3},"end":{"line":8,"column":9}},{"start":{"line":8,"column":14},"end":{"line":8,"column":25}}],"line":8},"1":{"loc":{"start":{"line":14,"column":3},"end":{"line":14,"column":30}},"type":"binary-expr","locations":[{"start":{"line":14,"column":3},"end":{"line":14,"column":11}},{"start":{"line":14,"column":16},"end":{"line":14,"column":29}}],"line":14},"2":{"loc":{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},"type":"if","locations":[{"start":{"line":34,"column":8},"end":{"line":36,"column":9}},{"start":{"line":34,"column":8},"end":{"line":36,"column":9}}],"line":34},"3":{"loc":{"start":{"line":47,"column":16},"end":{"line":49,"column":17}},"type":"if","locations":[{"start":{"line":47,"column":16},"end":{"line":49,"column":17}},{"start":{"line":47,"column":16},"end":{"line":49,"column":17}}],"line":47},"4":{"loc":{"start":{"line":50,"column":16},"end":{"line":52,"column":17}},"type":"if","locations":[{"start":{"line":50,"column":16},"end":{"line":52,"column":17}},{"start":{"line":50,"column":16},"end":{"line":52,"column":17}}],"line":50}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":18,"11":18,"12":18,"13":18,"14":18,"15":18,"16":11,"17":0,"18":5,"19":1,"20":0,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":0,"33":0,"34":1,"35":1},"f":{"0":1,"1":1,"2":18,"3":11,"4":0,"5":5,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":1,"15":1},"b":{"0":[1,1],"1":[1,1],"2":[0,1],"3":[1,0],"4":[1,0]},"inputSourceMap":{"version":3,"file":"CompactdModel.js","sourceRoot":"","sources":["CompactdModel.tsx"],"names":[],"mappings":"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","sourcesContent":["import Map from 'models/Map';\r\n\r\nexport enum Status {\r\n  BAREBONE, PREFETCHED, FETCHED, DELETED, DESTROYED\r\n}\r\n\r\nexport enum FindMode {\r\n  FETCH, PREFETCH, BAREBONE\r\n}\r\n\r\nexport interface ModelEventListener<T> {\r\n  onDelete: (id: string) => void;\r\n  onPropsChanged: (propName: string, newProps: T, oldProps: T) => void;\r\n}\r\n\r\nexport interface EventListenerUnbinder {\r\n  unbind: () => void;\r\n}\r\n\r\nexport abstract class CompactdModel<T> {\r\n  protected database: PouchDB.Database<T>;\r\n  protected pouchdb: PouchDB.Static;\r\n  protected _status: Status;\r\n  protected _id: string;\r\n  protected _fetch: typeof fetch;\r\n\r\n  protected listeners: Map<ModelEventListener<T>> = {};\r\n  private _live: boolean;\r\n\r\n  protected constructor (pouch: typeof PouchDB, f: typeof fetch, model: string, id: string, status: Status) {\r\n    this._fetch = f;\r\n    this._id = id;\r\n    this._status = status;\r\n    this.pouchdb = pouch;\r\n    this.database = new pouch<T>(model);\r\n  }\r\n  public get id () {\r\n    return this._id;\r\n  }\r\n  public get live () {\r\n    return this._live;\r\n  }\r\n  public get status ()  {\r\n    return this._status;\r\n  }\r\n  public abstract get props (): T;\r\n\r\n  public fetch () {\r\n    if (this._status === Status.FETCHED) {\r\n      return;\r\n    }\r\n    return this.pull().then(() => {\r\n       this._status = Status.FETCHED;\r\n    });\r\n  }\r\n  \r\n  protected abstract pull (): Promise<void>;\r\n  public abstract delete (): Promise<void>;\r\n\r\n  public addEventListener (listener: ModelEventListener<T>): EventListenerUnbinder {\r\n    const key = Date.now();\r\n    this.listeners[key] = listener;\r\n\r\n    this.attachFeed();\r\n\r\n    return {\r\n      unbind: () => {\r\n        if (this.listeners[key]) {\r\n          delete this.listeners[key];\r\n        }\r\n        if (Object.keys(this.listeners).length === 0) {\r\n          this.detachFeed();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // public feed (callback: (props: T & {_rev: string}) => void) {\r\n  //   enum feedState {\r\n  //     cancelled, paused, running, created\r\n  //   }\r\n  //   let state = feedState.created;\r\n  //   let unbinder: EventListenerUnbinder;\r\n  //   const funcs = {\r\n  //     cancel: () => {\r\n  //       if (state === feedState.cancelled) {\r\n  //         throw new Error('Cannot cancel an already cancelled feed');\r\n  //       }\r\n  //       funcs.pause();\r\n  //     },\r\n  //     pause: () => {\r\n  //       if (state !== feedState.running) {\r\n  //         return;\r\n  //       }\r\n  //       unbinder.unbind();\r\n  //       unbinder = null;\r\n  //     },\r\n  //     start: () => {\r\n  //       if (state === feedState.paused) {\r\n  //         return;\r\n  //       }\r\n  //       if (state === feedState.cancelled) {\r\n  //         throw new Error('Cannot start a cancelled feed');\r\n  //       }\r\n  //       if ([Status.PREFETCHED, Status.BAREBONE].includes(this.status)) {\r\n  //         this.pull().then(() => {\r\n  //           funcs.start();\r\n  //         });\r\n  //         return;\r\n  //       }\r\n  //       unbinder = this.addOnPropsChangedListener((name, newProps) => {\r\n  //         callback(newProps);\r\n  //       });\r\n  //       state = feedState.running;\r\n  //     }\r\n  //   }\r\n  //   return funcs;\r\n  // }\r\n\r\n  public addOnPropsChangedListener (callback: (propName: string, newProps: T & {_rev: string}, oldProps: T) => void) {\r\n    return this.addEventListener({\r\n      onPropsChanged: callback,\r\n      onDelete: () => {}\r\n    });\r\n  }\r\n\r\n  protected fireOnDelete (id: string) {\r\n    Object.values(this.listeners).forEach((listener) => {\r\n      listener.onDelete(id);\r\n    });\r\n  }\r\n\r\n  protected fireOnPropsChanged (propName: string, newProps: T, oldProps: T) {\r\n    Object.values(this.listeners).forEach((listener) => {\r\n      listener.onPropsChanged(propName, newProps, oldProps)\r\n    });\r\n  }\r\n  \r\n  protected abstract attachFeed (): void;\r\n  protected abstract detachFeed (): void;\r\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"60dae077c8525f1820db97bb837464e37f5ac283"}
}
